C51 COMPILER V9.52.0.0   SG90                                                              04/23/2024 21:01:14 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE SG90
OBJECT MODULE PLACED IN sg90.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE sg90.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "reg52.h"
   2          #include "delay.h"
   3          
   4          sbit sg90_con = P1^1;
   5          int jd;//角度;
   6          int cnt = 0;//记录爆表次数
   7          
   8          
   9          void Time0Init(){
  10   1        TMOD &= 0xF0; //设置定时器模式
  11   1        TMOD |= 0x01;
  12   1        //给初值，定义一个0.5ms来
  13   1        TL0 = 0x33;
  14   1        TH0 = 0xFE;
  15   1        //开始计时
  16   1        TR0 = 1;
  17   1        TF0 = 0;
  18   1        
  19   1        //打开定时器0中断
  20   1        ET0 = 1;
  21   1        //打开总中断EA
  22   1        EA = 1;
  23   1      }
  24          
  25          /*
  26          十进制2左移1位，变成20。相当于乘以10
  27          二禁止1左移1位，变成10（2）。相当于乘以2，左移8位，乘以2的8次方=256；*/
  28          
  29          
  30          
  31          void sgMiddle(){
  32   1        
  33   1            jd = 3;//90度
  34   1            cnt = 0;
  35   1            
  36   1      }
  37          
  38          void sgRight(){
  39   1              jd = 1;//0度
  40   1            cnt = 0;
  41   1      }
  42          
  43          void sgLeft(){
  44   1            jd = 5;//135度
  45   1            cnt = 0;
  46   1      }
  47          
  48          
  49          void Time0Handler() interrupt 1{
  50   1        
  51   1            cnt++;//统计爆表次数
  52   1            //重新给初值
  53   1            TL0 = 0x33;
  54   1            TH0 = 0xFE;
  55   1        
C51 COMPILER V9.52.0.0   SG90                                                              04/23/2024 21:01:14 PAGE 2   

  56   1            //控制PWM波
  57   1            if(cnt < jd){
  58   2              sg90_con = 1;
  59   2            }else{
  60   2              sg90_con = 0;
  61   2            }
  62   1            
  63   1            if(cnt == 40){//爆表40次，经过了20ms
  64   2              cnt = 0; //
  65   2              sg90_con = 1;
  66   2            }
  67   1          
  68   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    124    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
